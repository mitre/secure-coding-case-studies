## 1. Title
**Critical Remote Code Execution via Null Byte Handling in Wing FTP Server (CVE-2025-47812)**

---

## 2. Introduction
In July 2025, a severe vulnerability was disclosed in **Wing FTP Server**, tracked as **CVE-2025-47812**. This flaw allowed attackers to execute arbitrary system commands remotely, leading to complete server compromise. With a CVSS score of **10.0 (Critical)**, the vulnerability quickly became a target for active exploitation in the wild.

---

## 3. Software
- **Product:** Wing FTP Server  
- **Versions Affected:** Prior to 7.4.4  
- **Platforms:** Cross-platform (Windows, Linux, macOS)  
- **Purpose:** A secure, user-friendly FTP server supporting FTP, FTPS, HTTP, HTTPS, and SFTP protocols.

---

## 4. Weakness
- **CWE-20: Improper Input Validation**  
- **CWE-94: Improper Control of Code Generation (‘Code Injection’)**  
The root weakness was improper handling of **null (`\0`) bytes** in web interfaces, which allowed unsafe injection of Lua code into session files.

---

## 5. Vulnerability
The **user and admin web interfaces mishandled null bytes**, enabling attackers to craft malicious input that injected arbitrary Lua code into session files. Because Wing FTP Server executes Lua scripts internally, this flaw escalated into **remote code execution (RCE)** with **root/SYSTEM privileges**.

---

## 6. Exploit
Attackers could exploit the vulnerability by:
- Sending crafted requests with embedded `\0` bytes.  
- Injecting malicious Lua payloads into session files.  
- Triggering execution of arbitrary system commands.  

Proof-of-concept exploits were quickly published on GitHub, demonstrating how even **anonymous FTP accounts** could achieve full compromise.

---

## 7. Fix
- **Vendor Patch:** Wing FTP Server version **7.4.4** fixed the issue by properly sanitizing null byte input and restricting unsafe Lua code execution.  
- **Mitigation Guidance:** CISA urged organizations to patch before **August 4, 2025**, due to active exploitation.

---

## 8. Prevention
Systemic prevention strategies include:
- **Secure Input Validation:** Strictly reject or sanitize null bytes and other control characters.  
- **Least Privilege Execution:** Avoid running services with root/SYSTEM privileges; use dedicated low-privilege accounts.  
- **Disable Dangerous Features:** Restrict or sandbox embedded scripting languages (Lua) in server applications.  
- **Supply Chain Monitoring:** Maintain SBOMs and automate dependency vulnerability scanning.  
- **Defense-in-Depth:** Employ intrusion detection, WAFs, and runtime monitoring to catch abnormal behavior.  
- **Rapid Patch Management:** Establish processes for immediate vendor patch deployment when critical CVEs are announced.  

---

## 9. Conclusion
CVE-2025-47812 highlights how **improper input validation** and unsafe integration of scripting languages can lead to catastrophic compromise. By adopting **secure defaults, privilege minimization, and proactive patching**, organizations can prevent similar vulnerabilities from escalating into global crises.

---

## 10. References
- [NVD CVE-2025-47812](https://nvd.nist.gov/vuln/detail/CVE-2025-47812)  
- [GitHub PoC Exploit](https://github.com/4m3rr0r/CVE-2025-47812-poc)  
- [Qualys ThreatProtect Advisory](https://threatprotect.qualys.com/2025/07/02/wingftp-critical-remote-code-execution-vulnerability-cve-2025-47812/)  
- [Tenable CVE-2025-47812](https://www.tenable.com/cve/CVE-2025-47812)  
- [The Hacker News Coverage](https://thehackernews.com/2025/07/critical-wing-ftp-server-vulnerability.html)  

---

## 11. Contributions
- **Discovery:** Julien Ahrens (@MrTuxracer) of RCE Security.  
- **Exploit Development:** Community researchers published proof-of-concept exploits on GitHub.  
- **Mitigation Advocacy:** CISA added CVE-2025-47812 to its **Known Exploited Vulnerabilities Catalog**, urging rapid patching.  
- **Vendor Response:** Wing FTP Server developers released version 7.4.4 to address the flaw.  
